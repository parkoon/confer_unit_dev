<!DOCTYPE html>
<html>

<body>

    <!-- really dirty! this is just a test drive ;) -->

    <script type="text/javascript" src="./build/pdf.js"></script>
    <script type="text/javascript">

        function renderPDF(url) {
            PDFJS.getDocument(url).then((pdf) => {
                for (let i = 1; i <= pdf.numPages; i += 1) {
                    const canvas = document.createElement('canvas');
                    /* This indentify the canvas as the location of the page */
                    canvas.id = 'pdf'+i;
                    document.getElementById('holder').appendChild(canvas);
                    pdf.getPage(i).then((page) => {
                        renderPage(page, canvas);
                    });
                }
            });
        }

        function renderPage(page, canvas) {
            const viewport = page.getViewport(1);
            const canvasContext = canvas.getContext('2d');
            const renderContext = {
                canvasContext,
                viewport
            };
            canvas.height = viewport.height;
            canvas.width = viewport.width;
            var task = page.render(renderContext);
            task.promise.then(function () {
                // console.log(canvas.toDataURL('image/png'));
                var link = document.createElement('a');
                alert(canvas.id+'.png');
                link.download = canvas.id+'.png';
                link.href = canvas.toDataURL("image/png").replace("image/png", "image/octet-stream");
                link.click();
            });
            
        }

    </script>

    <div id="holder"></div>

    <script type="text/javascript">
        renderPDF('sample.pdf', document.getElementById('holder'));
    </script>

</body>

</html>